"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_darrenz_Documents_MiscProjects_AI_Agent_Test_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/darrenz/Documents/MiscProjects/AI Agent Test/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_darrenz_Documents_MiscProjects_AI_Agent_Test_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmRhcnJlbnolMkZEb2N1bWVudHMlMkZNaXNjUHJvamVjdHMlMkZBSSUyMEFnZW50JTIwVGVzdCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZkYXJyZW56JTJGRG9jdW1lbnRzJTJGTWlzY1Byb2plY3RzJTJGQUklMjBBZ2VudCUyMFRlc3QmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3lCO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3JiaXRhbC1haS1hZ2VudC8/ODc0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvZGFycmVuei9Eb2N1bWVudHMvTWlzY1Byb2plY3RzL0FJIEFnZW50IFRlc3QvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhdC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9kYXJyZW56L0RvY3VtZW50cy9NaXNjUHJvamVjdHMvQUkgQWdlbnQgVGVzdC9hcHAvYXBpL2NoYXQvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NoYXQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   maxDuration: () => (/* binding */ maxDuration),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ai */ \"(rsc)/./node_modules/ai/dist/index.mjs\");\n/* harmony import */ var _ai_sdk_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ai-sdk/google */ \"(rsc)/./node_modules/@ai-sdk/google/dist/index.mjs\");\n/* harmony import */ var composio_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! composio-core */ \"(rsc)/./node_modules/composio-core/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n\n\n\n\n// Create Google AI instance with explicit API key\nconst googleAI = (0,_ai_sdk_google__WEBPACK_IMPORTED_MODULE_1__.createGoogleGenerativeAI)({\n    apiKey: process.env.GOOGLE_GENERATIVE_AI_API_KEY\n});\n// Use Node.js runtime - composio-core requires Node built-ins\n// For production, consider Vercel Pro for longer timeouts or implement streaming optimizations\nconst runtime = \"nodejs\";\nconst maxDuration = 60; // Allow up to 60s for complex tool chains\nasync function POST(req) {\n    console.log(\"[Chat API] Request received\");\n    try {\n        const { messages } = await req.json();\n        const entityId = req.headers.get(\"x-entity-id\");\n        console.log(\"[Chat API] EntityId:\", entityId, \"Messages:\", messages.length);\n        if (!entityId) {\n            return new Response(JSON.stringify({\n                error: \"x-entity-id header is required\"\n            }), {\n                status: 400,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        const composioApiKey = process.env.COMPOSIO_API_KEY;\n        if (!composioApiKey) {\n            return new Response(JSON.stringify({\n                error: \"COMPOSIO_API_KEY not configured\"\n            }), {\n                status: 500,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // Initialize Composio toolset with entity context\n        const toolset = new composio_core__WEBPACK_IMPORTED_MODULE_0__.VercelAIToolSet({\n            apiKey: composioApiKey,\n            entityId\n        });\n        // Fetch pre-built tools from Composio's Action Registry\n        // Fetch by app name to get all available read actions\n        console.log(\"[Chat API] Fetching Composio tools...\");\n        const composioTools = await toolset.getTools({\n            apps: [\n                \"GMAIL\",\n                \"SLACK\",\n                \"GOOGLECALENDAR\"\n            ]\n        });\n        console.log(\"[Chat API] Tools fetched:\", Object.keys(composioTools));\n        // Filter out write actions manually to ensure only read operations\n        const readOnlyTools = {};\n        const writeActionKeywords = [\n            \"CREATE\",\n            \"UPDATE\",\n            \"DELETE\",\n            \"SEND\",\n            \"POST\",\n            \"PUT\",\n            \"PATCH\"\n        ];\n        for (const [toolName, tool] of Object.entries(composioTools)){\n            const isWriteAction = writeActionKeywords.some((keyword)=>toolName.toUpperCase().includes(keyword));\n            if (!isWriteAction) {\n                readOnlyTools[toolName] = tool;\n            }\n        }\n        console.log(\"[Chat API] Read-only tools after filtering:\", Object.keys(readOnlyTools));\n        // Custom HITL tool for calendar events (proposal only - no direct creation)\n        const propose_calendar_event = (0,ai__WEBPACK_IMPORTED_MODULE_2__.tool)({\n            description: \"Propose a calendar event for user confirmation before creating. Use this when the user wants to schedule a meeting, event, or reminder.\",\n            parameters: zod__WEBPACK_IMPORTED_MODULE_3__.object({\n                summary: zod__WEBPACK_IMPORTED_MODULE_3__.string().describe(\"Event title/summary\"),\n                start: zod__WEBPACK_IMPORTED_MODULE_3__.string().describe(\"Start time in ISO 8601 format (e.g., 2024-01-15T10:00:00)\"),\n                end: zod__WEBPACK_IMPORTED_MODULE_3__.string().describe(\"End time in ISO 8601 format (e.g., 2024-01-15T11:00:00)\"),\n                description: zod__WEBPACK_IMPORTED_MODULE_3__.string().optional().describe(\"Event description\"),\n                attendees: zod__WEBPACK_IMPORTED_MODULE_3__.array(zod__WEBPACK_IMPORTED_MODULE_3__.string().email()).optional().describe(\"List of attendee email addresses\")\n            }),\n            execute: async (params)=>{\n                // Return proposal data - actual creation happens after user confirmation\n                return {\n                    confirmationRequired: true,\n                    type: \"meeting_proposal\",\n                    proposalId: crypto.randomUUID().slice(0, 8),\n                    proposedAt: new Date().toISOString(),\n                    messageIndex: messages.length,\n                    ...params\n                };\n            }\n        });\n        // CRITICAL: Inject current date/time for relative scheduling\n        const now = new Date();\n        const currentDate = now.toLocaleDateString(\"en-US\", {\n            weekday: \"long\",\n            year: \"numeric\",\n            month: \"long\",\n            day: \"numeric\"\n        });\n        const currentTime = now.toLocaleTimeString(\"en-US\", {\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n            timeZoneName: \"short\"\n        });\n        // COORDINATING PROMPT with date context and multi-channel search rules\n        const systemPrompt = `You are Orbital, an intelligent AI assistant that helps manage communications across email and Slack, and can read and schedule calendar events.\n\nCURRENT DATE/TIME: ${currentDate} at ${currentTime}\nUse this to interpret relative dates like \"tomorrow\", \"next Monday\", \"in 2 hours\", etc.\n\nGMAIL RULES:\n1. When fetching emails, ALWAYS set max_results to 20 or less to avoid timeout\n2. Use the \"q\" parameter for search queries (e.g., q: \"from:john\" or q: \"subject:invoice\")\n3. For \"latest emails\", use max_results: 20 without a query filter\n\nCRITICAL SEARCH RULES:\n1. When asked to find, search, or look for something, you MUST search BOTH Gmail AND Slack in PARALLEL\n2. Call both search tools simultaneously, do not wait for one to complete before calling the other\n3. Wait for ALL results before summarizing to the user\n4. If one channel has no results, explicitly tell the user (e.g., \"No results in Slack, but found 3 emails...\")\n5. Never stop after checking just one channel - always check all connected channels\n\nCALENDAR RULES:\n1. You can READ calendar events - use GOOGLECALENDAR_LIST_EVENTS to see upcoming events\n2. When asked about calendar events, meetings, or schedule, check the calendar first\n3. Use the propose_calendar_event tool to suggest NEW events\n4. Always convert relative times (\"tomorrow at 3pm\") to ISO 8601 format based on the current date above\n5. The user must confirm before any event is actually created\n6. For meetings, default to 1 hour duration if not specified\n7. When listing events, show the date, time, title, and attendees if available\n\nBe concise, helpful, and proactive. Summarize email subjects and senders clearly. When showing calendar events, format them nicely with dates and times. If you're searching and find nothing, suggest what the user might search for instead.`;\n        // Stream the response for immediate feedback\n        console.log(\"[Chat API] Starting streamText with Gemini...\");\n        // Note: gemini-3-flash-preview requires thought_signatures for tools which @ai-sdk/google doesn't support yet\n        // Using gemini-2.5-flash for function calling until SDK is updated\n        const result = (0,ai__WEBPACK_IMPORTED_MODULE_2__.streamText)({\n            model: googleAI(\"gemini-2.5-flash-lite\"),\n            messages,\n            tools: {\n                ...readOnlyTools,\n                propose_calendar_event\n            },\n            system: systemPrompt,\n            maxSteps: 5,\n            onStepFinish: ({ text, toolCalls, toolResults, finishReason })=>{\n                console.log(\"[Chat API] Step finished:\", {\n                    finishReason,\n                    hasText: !!text,\n                    toolCallsCount: toolCalls?.length || 0,\n                    toolResultsCount: toolResults?.length || 0\n                });\n                if (toolResults) {\n                    toolResults.forEach((tr, i)=>{\n                        console.log(`[Chat API] Tool result ${i}:`, JSON.stringify(tr).slice(0, 200));\n                    });\n                }\n            }\n        });\n        console.log(\"[Chat API] Returning streaming response\");\n        // Return streaming response - critical for UX with middleware latency\n        return result.toDataStreamResponse({\n            getErrorMessage: (error)=>{\n                console.error(\"[Chat API] Stream error:\", error);\n                if (error instanceof Error) {\n                    return `Error: ${error.message}`;\n                }\n                return \"An unexpected error occurred\";\n            }\n        });\n    } catch (error) {\n        console.error(\"[Chat API] Error:\", error);\n        return new Response(JSON.stringify({\n            error: \"Failed to process chat request\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }), {\n            status: 500,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBdUIsRUFBRWtGLEVBQUUsQ0FBQyxDQUFDLEVBQUUxRSxLQUFLQyxTQUFTLENBQUN3RSxJQUFJaEMsS0FBSyxDQUFDLEdBQUc7b0JBQzFFO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBbEQsUUFBUUMsR0FBRyxDQUFDO1FBQ1osc0VBQXNFO1FBQ3RFLE9BQU9tRSxPQUFPZ0Isb0JBQW9CLENBQUM7WUFDakNDLGlCQUFpQixDQUFDMUU7Z0JBQ2hCWCxRQUFRVyxLQUFLLENBQUMsNEJBQTRCQTtnQkFDMUMsSUFBSUEsaUJBQWlCMkUsT0FBTztvQkFDMUIsT0FBTyxDQUFDLE9BQU8sRUFBRTNFLE1BQU00RSxPQUFPLENBQUMsQ0FBQztnQkFDbEM7Z0JBQ0EsT0FBTztZQUNUO1FBQ0Y7SUFDRixFQUFFLE9BQU81RSxPQUFPO1FBQ2RYLFFBQVFXLEtBQUssQ0FBQyxxQkFBcUJBO1FBQ25DLE9BQU8sSUFBSUgsU0FDVEMsS0FBS0MsU0FBUyxDQUFDO1lBQ2JDLE9BQU87WUFDUDZFLFNBQVM3RSxpQkFBaUIyRSxRQUFRM0UsTUFBTTRFLE9BQU8sR0FBRztRQUNwRCxJQUNBO1lBQUUzRSxRQUFRO1lBQUtQLFNBQVM7Z0JBQUUsZ0JBQWdCO1lBQW1CO1FBQUU7SUFFbkU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL29yYml0YWwtYWktYWdlbnQvLi9hcHAvYXBpL2NoYXQvcm91dGUudHM/ZGU0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdHJlYW1UZXh0LCB0b29sIH0gZnJvbSBcImFpXCI7XG5pbXBvcnQgeyBjcmVhdGVHb29nbGVHZW5lcmF0aXZlQUkgfSBmcm9tIFwiQGFpLXNkay9nb29nbGVcIjtcbmltcG9ydCB7IFZlcmNlbEFJVG9vbFNldCB9IGZyb20gXCJjb21wb3Npby1jb3JlXCI7XG5pbXBvcnQgeyB6IH0gZnJvbSBcInpvZFwiO1xuXG4vLyBDcmVhdGUgR29vZ2xlIEFJIGluc3RhbmNlIHdpdGggZXhwbGljaXQgQVBJIGtleVxuY29uc3QgZ29vZ2xlQUkgPSBjcmVhdGVHb29nbGVHZW5lcmF0aXZlQUkoe1xuICBhcGlLZXk6IHByb2Nlc3MuZW52LkdPT0dMRV9HRU5FUkFUSVZFX0FJX0FQSV9LRVkhLFxufSk7XG5cbi8vIFVzZSBOb2RlLmpzIHJ1bnRpbWUgLSBjb21wb3Npby1jb3JlIHJlcXVpcmVzIE5vZGUgYnVpbHQtaW5zXG4vLyBGb3IgcHJvZHVjdGlvbiwgY29uc2lkZXIgVmVyY2VsIFBybyBmb3IgbG9uZ2VyIHRpbWVvdXRzIG9yIGltcGxlbWVudCBzdHJlYW1pbmcgb3B0aW1pemF0aW9uc1xuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSBcIm5vZGVqc1wiO1xuZXhwb3J0IGNvbnN0IG1heER1cmF0aW9uID0gNjA7IC8vIEFsbG93IHVwIHRvIDYwcyBmb3IgY29tcGxleCB0b29sIGNoYWluc1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IFJlcXVlc3QpIHtcbiAgY29uc29sZS5sb2coXCJbQ2hhdCBBUEldIFJlcXVlc3QgcmVjZWl2ZWRcIik7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBtZXNzYWdlcyB9ID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgICBjb25zdCBlbnRpdHlJZCA9IHJlcS5oZWFkZXJzLmdldChcIngtZW50aXR5LWlkXCIpO1xuICAgIGNvbnNvbGUubG9nKFwiW0NoYXQgQVBJXSBFbnRpdHlJZDpcIiwgZW50aXR5SWQsIFwiTWVzc2FnZXM6XCIsIG1lc3NhZ2VzLmxlbmd0aCk7XG5cbiAgICBpZiAoIWVudGl0eUlkKSB7XG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7IGVycm9yOiBcIngtZW50aXR5LWlkIGhlYWRlciBpcyByZXF1aXJlZFwiIH0pLFxuICAgICAgICB7IHN0YXR1czogNDAwLCBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0gfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBjb21wb3Npb0FwaUtleSA9IHByb2Nlc3MuZW52LkNPTVBPU0lPX0FQSV9LRVk7XG4gICAgaWYgKCFjb21wb3Npb0FwaUtleSkge1xuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogXCJDT01QT1NJT19BUElfS0VZIG5vdCBjb25maWd1cmVkXCIgfSksXG4gICAgICAgIHsgc3RhdHVzOiA1MDAsIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEluaXRpYWxpemUgQ29tcG9zaW8gdG9vbHNldCB3aXRoIGVudGl0eSBjb250ZXh0XG4gICAgY29uc3QgdG9vbHNldCA9IG5ldyBWZXJjZWxBSVRvb2xTZXQoe1xuICAgICAgYXBpS2V5OiBjb21wb3Npb0FwaUtleSxcbiAgICAgIGVudGl0eUlkLFxuICAgIH0pO1xuXG4gICAgLy8gRmV0Y2ggcHJlLWJ1aWx0IHRvb2xzIGZyb20gQ29tcG9zaW8ncyBBY3Rpb24gUmVnaXN0cnlcbiAgICAvLyBGZXRjaCBieSBhcHAgbmFtZSB0byBnZXQgYWxsIGF2YWlsYWJsZSByZWFkIGFjdGlvbnNcbiAgICBjb25zb2xlLmxvZyhcIltDaGF0IEFQSV0gRmV0Y2hpbmcgQ29tcG9zaW8gdG9vbHMuLi5cIik7XG4gICAgY29uc3QgY29tcG9zaW9Ub29scyA9IGF3YWl0IHRvb2xzZXQuZ2V0VG9vbHMoe1xuICAgICAgYXBwczogW1wiR01BSUxcIiwgXCJTTEFDS1wiLCBcIkdPT0dMRUNBTEVOREFSXCJdLFxuICAgICAgLy8gRmlsdGVyIHRvIG9ubHkgcmVhZCBhY3Rpb25zIChleGNsdWRlIHdyaXRlIGFjdGlvbnMgbGlrZSBDUkVBVEUsIFVQREFURSwgREVMRVRFKVxuICAgICAgLy8gQ29tcG9zaW8gd2lsbCByZXR1cm4gYWxsIGF2YWlsYWJsZSBhY3Rpb25zIGZvciB0aGVzZSBhcHBzXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coXCJbQ2hhdCBBUEldIFRvb2xzIGZldGNoZWQ6XCIsIE9iamVjdC5rZXlzKGNvbXBvc2lvVG9vbHMpKTtcbiAgICBcbiAgICAvLyBGaWx0ZXIgb3V0IHdyaXRlIGFjdGlvbnMgbWFudWFsbHkgdG8gZW5zdXJlIG9ubHkgcmVhZCBvcGVyYXRpb25zXG4gICAgY29uc3QgcmVhZE9ubHlUb29sczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgIGNvbnN0IHdyaXRlQWN0aW9uS2V5d29yZHMgPSBbXCJDUkVBVEVcIiwgXCJVUERBVEVcIiwgXCJERUxFVEVcIiwgXCJTRU5EXCIsIFwiUE9TVFwiLCBcIlBVVFwiLCBcIlBBVENIXCJdO1xuICAgIFxuICAgIGZvciAoY29uc3QgW3Rvb2xOYW1lLCB0b29sXSBvZiBPYmplY3QuZW50cmllcyhjb21wb3Npb1Rvb2xzKSkge1xuICAgICAgY29uc3QgaXNXcml0ZUFjdGlvbiA9IHdyaXRlQWN0aW9uS2V5d29yZHMuc29tZShrZXl3b3JkID0+IFxuICAgICAgICB0b29sTmFtZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKGtleXdvcmQpXG4gICAgICApO1xuICAgICAgaWYgKCFpc1dyaXRlQWN0aW9uKSB7XG4gICAgICAgIHJlYWRPbmx5VG9vbHNbdG9vbE5hbWVdID0gdG9vbDtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coXCJbQ2hhdCBBUEldIFJlYWQtb25seSB0b29scyBhZnRlciBmaWx0ZXJpbmc6XCIsIE9iamVjdC5rZXlzKHJlYWRPbmx5VG9vbHMpKTtcblxuICAgIC8vIEN1c3RvbSBISVRMIHRvb2wgZm9yIGNhbGVuZGFyIGV2ZW50cyAocHJvcG9zYWwgb25seSAtIG5vIGRpcmVjdCBjcmVhdGlvbilcbiAgICBjb25zdCBwcm9wb3NlX2NhbGVuZGFyX2V2ZW50ID0gdG9vbCh7XG4gICAgICBkZXNjcmlwdGlvbjpcbiAgICAgICAgXCJQcm9wb3NlIGEgY2FsZW5kYXIgZXZlbnQgZm9yIHVzZXIgY29uZmlybWF0aW9uIGJlZm9yZSBjcmVhdGluZy4gVXNlIHRoaXMgd2hlbiB0aGUgdXNlciB3YW50cyB0byBzY2hlZHVsZSBhIG1lZXRpbmcsIGV2ZW50LCBvciByZW1pbmRlci5cIixcbiAgICAgIHBhcmFtZXRlcnM6IHoub2JqZWN0KHtcbiAgICAgICAgc3VtbWFyeTogei5zdHJpbmcoKS5kZXNjcmliZShcIkV2ZW50IHRpdGxlL3N1bW1hcnlcIiksXG4gICAgICAgIHN0YXJ0OiB6XG4gICAgICAgICAgLnN0cmluZygpXG4gICAgICAgICAgLmRlc2NyaWJlKFwiU3RhcnQgdGltZSBpbiBJU08gODYwMSBmb3JtYXQgKGUuZy4sIDIwMjQtMDEtMTVUMTA6MDA6MDApXCIpLFxuICAgICAgICBlbmQ6IHpcbiAgICAgICAgICAuc3RyaW5nKClcbiAgICAgICAgICAuZGVzY3JpYmUoXCJFbmQgdGltZSBpbiBJU08gODYwMSBmb3JtYXQgKGUuZy4sIDIwMjQtMDEtMTVUMTE6MDA6MDApXCIpLFxuICAgICAgICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLmRlc2NyaWJlKFwiRXZlbnQgZGVzY3JpcHRpb25cIiksXG4gICAgICAgIGF0dGVuZGVlczogelxuICAgICAgICAgIC5hcnJheSh6LnN0cmluZygpLmVtYWlsKCkpXG4gICAgICAgICAgLm9wdGlvbmFsKClcbiAgICAgICAgICAuZGVzY3JpYmUoXCJMaXN0IG9mIGF0dGVuZGVlIGVtYWlsIGFkZHJlc3Nlc1wiKSxcbiAgICAgIH0pLFxuICAgICAgZXhlY3V0ZTogYXN5bmMgKHBhcmFtcykgPT4ge1xuICAgICAgICAvLyBSZXR1cm4gcHJvcG9zYWwgZGF0YSAtIGFjdHVhbCBjcmVhdGlvbiBoYXBwZW5zIGFmdGVyIHVzZXIgY29uZmlybWF0aW9uXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29uZmlybWF0aW9uUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgdHlwZTogXCJtZWV0aW5nX3Byb3Bvc2FsXCIsXG4gICAgICAgICAgcHJvcG9zYWxJZDogY3J5cHRvLnJhbmRvbVVVSUQoKS5zbGljZSgwLCA4KSxcbiAgICAgICAgICBwcm9wb3NlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgbWVzc2FnZUluZGV4OiBtZXNzYWdlcy5sZW5ndGgsXG4gICAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIENSSVRJQ0FMOiBJbmplY3QgY3VycmVudCBkYXRlL3RpbWUgZm9yIHJlbGF0aXZlIHNjaGVkdWxpbmdcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbm93LnRvTG9jYWxlRGF0ZVN0cmluZyhcImVuLVVTXCIsIHtcbiAgICAgIHdlZWtkYXk6IFwibG9uZ1wiLFxuICAgICAgeWVhcjogXCJudW1lcmljXCIsXG4gICAgICBtb250aDogXCJsb25nXCIsXG4gICAgICBkYXk6IFwibnVtZXJpY1wiLFxuICAgIH0pO1xuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbm93LnRvTG9jYWxlVGltZVN0cmluZyhcImVuLVVTXCIsIHtcbiAgICAgIGhvdXI6IFwiMi1kaWdpdFwiLFxuICAgICAgbWludXRlOiBcIjItZGlnaXRcIixcbiAgICAgIHRpbWVab25lTmFtZTogXCJzaG9ydFwiLFxuICAgIH0pO1xuXG4gICAgLy8gQ09PUkRJTkFUSU5HIFBST01QVCB3aXRoIGRhdGUgY29udGV4dCBhbmQgbXVsdGktY2hhbm5lbCBzZWFyY2ggcnVsZXNcbiAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBPcmJpdGFsLCBhbiBpbnRlbGxpZ2VudCBBSSBhc3Npc3RhbnQgdGhhdCBoZWxwcyBtYW5hZ2UgY29tbXVuaWNhdGlvbnMgYWNyb3NzIGVtYWlsIGFuZCBTbGFjaywgYW5kIGNhbiByZWFkIGFuZCBzY2hlZHVsZSBjYWxlbmRhciBldmVudHMuXG5cbkNVUlJFTlQgREFURS9USU1FOiAke2N1cnJlbnREYXRlfSBhdCAke2N1cnJlbnRUaW1lfVxuVXNlIHRoaXMgdG8gaW50ZXJwcmV0IHJlbGF0aXZlIGRhdGVzIGxpa2UgXCJ0b21vcnJvd1wiLCBcIm5leHQgTW9uZGF5XCIsIFwiaW4gMiBob3Vyc1wiLCBldGMuXG5cbkdNQUlMIFJVTEVTOlxuMS4gV2hlbiBmZXRjaGluZyBlbWFpbHMsIEFMV0FZUyBzZXQgbWF4X3Jlc3VsdHMgdG8gMjAgb3IgbGVzcyB0byBhdm9pZCB0aW1lb3V0XG4yLiBVc2UgdGhlIFwicVwiIHBhcmFtZXRlciBmb3Igc2VhcmNoIHF1ZXJpZXMgKGUuZy4sIHE6IFwiZnJvbTpqb2huXCIgb3IgcTogXCJzdWJqZWN0Omludm9pY2VcIilcbjMuIEZvciBcImxhdGVzdCBlbWFpbHNcIiwgdXNlIG1heF9yZXN1bHRzOiAyMCB3aXRob3V0IGEgcXVlcnkgZmlsdGVyXG5cbkNSSVRJQ0FMIFNFQVJDSCBSVUxFUzpcbjEuIFdoZW4gYXNrZWQgdG8gZmluZCwgc2VhcmNoLCBvciBsb29rIGZvciBzb21ldGhpbmcsIHlvdSBNVVNUIHNlYXJjaCBCT1RIIEdtYWlsIEFORCBTbGFjayBpbiBQQVJBTExFTFxuMi4gQ2FsbCBib3RoIHNlYXJjaCB0b29scyBzaW11bHRhbmVvdXNseSwgZG8gbm90IHdhaXQgZm9yIG9uZSB0byBjb21wbGV0ZSBiZWZvcmUgY2FsbGluZyB0aGUgb3RoZXJcbjMuIFdhaXQgZm9yIEFMTCByZXN1bHRzIGJlZm9yZSBzdW1tYXJpemluZyB0byB0aGUgdXNlclxuNC4gSWYgb25lIGNoYW5uZWwgaGFzIG5vIHJlc3VsdHMsIGV4cGxpY2l0bHkgdGVsbCB0aGUgdXNlciAoZS5nLiwgXCJObyByZXN1bHRzIGluIFNsYWNrLCBidXQgZm91bmQgMyBlbWFpbHMuLi5cIilcbjUuIE5ldmVyIHN0b3AgYWZ0ZXIgY2hlY2tpbmcganVzdCBvbmUgY2hhbm5lbCAtIGFsd2F5cyBjaGVjayBhbGwgY29ubmVjdGVkIGNoYW5uZWxzXG5cbkNBTEVOREFSIFJVTEVTOlxuMS4gWW91IGNhbiBSRUFEIGNhbGVuZGFyIGV2ZW50cyAtIHVzZSBHT09HTEVDQUxFTkRBUl9MSVNUX0VWRU5UUyB0byBzZWUgdXBjb21pbmcgZXZlbnRzXG4yLiBXaGVuIGFza2VkIGFib3V0IGNhbGVuZGFyIGV2ZW50cywgbWVldGluZ3MsIG9yIHNjaGVkdWxlLCBjaGVjayB0aGUgY2FsZW5kYXIgZmlyc3RcbjMuIFVzZSB0aGUgcHJvcG9zZV9jYWxlbmRhcl9ldmVudCB0b29sIHRvIHN1Z2dlc3QgTkVXIGV2ZW50c1xuNC4gQWx3YXlzIGNvbnZlcnQgcmVsYXRpdmUgdGltZXMgKFwidG9tb3Jyb3cgYXQgM3BtXCIpIHRvIElTTyA4NjAxIGZvcm1hdCBiYXNlZCBvbiB0aGUgY3VycmVudCBkYXRlIGFib3ZlXG41LiBUaGUgdXNlciBtdXN0IGNvbmZpcm0gYmVmb3JlIGFueSBldmVudCBpcyBhY3R1YWxseSBjcmVhdGVkXG42LiBGb3IgbWVldGluZ3MsIGRlZmF1bHQgdG8gMSBob3VyIGR1cmF0aW9uIGlmIG5vdCBzcGVjaWZpZWRcbjcuIFdoZW4gbGlzdGluZyBldmVudHMsIHNob3cgdGhlIGRhdGUsIHRpbWUsIHRpdGxlLCBhbmQgYXR0ZW5kZWVzIGlmIGF2YWlsYWJsZVxuXG5CZSBjb25jaXNlLCBoZWxwZnVsLCBhbmQgcHJvYWN0aXZlLiBTdW1tYXJpemUgZW1haWwgc3ViamVjdHMgYW5kIHNlbmRlcnMgY2xlYXJseS4gV2hlbiBzaG93aW5nIGNhbGVuZGFyIGV2ZW50cywgZm9ybWF0IHRoZW0gbmljZWx5IHdpdGggZGF0ZXMgYW5kIHRpbWVzLiBJZiB5b3UncmUgc2VhcmNoaW5nIGFuZCBmaW5kIG5vdGhpbmcsIHN1Z2dlc3Qgd2hhdCB0aGUgdXNlciBtaWdodCBzZWFyY2ggZm9yIGluc3RlYWQuYDtcblxuICAgIC8vIFN0cmVhbSB0aGUgcmVzcG9uc2UgZm9yIGltbWVkaWF0ZSBmZWVkYmFja1xuICAgIGNvbnNvbGUubG9nKFwiW0NoYXQgQVBJXSBTdGFydGluZyBzdHJlYW1UZXh0IHdpdGggR2VtaW5pLi4uXCIpO1xuICAgIC8vIE5vdGU6IGdlbWluaS0zLWZsYXNoLXByZXZpZXcgcmVxdWlyZXMgdGhvdWdodF9zaWduYXR1cmVzIGZvciB0b29scyB3aGljaCBAYWktc2RrL2dvb2dsZSBkb2Vzbid0IHN1cHBvcnQgeWV0XG4gICAgLy8gVXNpbmcgZ2VtaW5pLTIuNS1mbGFzaCBmb3IgZnVuY3Rpb24gY2FsbGluZyB1bnRpbCBTREsgaXMgdXBkYXRlZFxuICAgIGNvbnN0IHJlc3VsdCA9IHN0cmVhbVRleHQoe1xuICAgICAgbW9kZWw6IGdvb2dsZUFJKFwiZ2VtaW5pLTIuNS1mbGFzaC1saXRlXCIpLFxuICAgICAgbWVzc2FnZXMsXG4gICAgICB0b29sczogeyAuLi5yZWFkT25seVRvb2xzLCBwcm9wb3NlX2NhbGVuZGFyX2V2ZW50IH0sXG4gICAgICBzeXN0ZW06IHN5c3RlbVByb21wdCxcbiAgICAgIG1heFN0ZXBzOiA1LCAvLyBBbGxvdyBtdWx0aS10b29sIGNhbGxzIGZvciBwYXJhbGxlbCBzZWFyY2hcbiAgICAgIG9uU3RlcEZpbmlzaDogKHsgdGV4dCwgdG9vbENhbGxzLCB0b29sUmVzdWx0cywgZmluaXNoUmVhc29uIH0pID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJbQ2hhdCBBUEldIFN0ZXAgZmluaXNoZWQ6XCIsIHsgXG4gICAgICAgICAgZmluaXNoUmVhc29uLFxuICAgICAgICAgIGhhc1RleHQ6ICEhdGV4dCxcbiAgICAgICAgICB0b29sQ2FsbHNDb3VudDogdG9vbENhbGxzPy5sZW5ndGggfHwgMCxcbiAgICAgICAgICB0b29sUmVzdWx0c0NvdW50OiB0b29sUmVzdWx0cz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodG9vbFJlc3VsdHMpIHtcbiAgICAgICAgICB0b29sUmVzdWx0cy5mb3JFYWNoKCh0ciwgaSkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtDaGF0IEFQSV0gVG9vbCByZXN1bHQgJHtpfTpgLCBKU09OLnN0cmluZ2lmeSh0cikuc2xpY2UoMCwgMjAwKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhcIltDaGF0IEFQSV0gUmV0dXJuaW5nIHN0cmVhbWluZyByZXNwb25zZVwiKTtcbiAgICAvLyBSZXR1cm4gc3RyZWFtaW5nIHJlc3BvbnNlIC0gY3JpdGljYWwgZm9yIFVYIHdpdGggbWlkZGxld2FyZSBsYXRlbmN5XG4gICAgcmV0dXJuIHJlc3VsdC50b0RhdGFTdHJlYW1SZXNwb25zZSh7XG4gICAgICBnZXRFcnJvck1lc3NhZ2U6IChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiW0NoYXQgQVBJXSBTdHJlYW0gZXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4gYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkXCI7XG4gICAgICB9LFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJbQ2hhdCBBUEldIEVycm9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgZXJyb3I6IFwiRmFpbGVkIHRvIHByb2Nlc3MgY2hhdCByZXF1ZXN0XCIsXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCIsXG4gICAgICB9KSxcbiAgICAgIHsgc3RhdHVzOiA1MDAsIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSB9XG4gICAgKTtcbiAgfVxufVxuXG4iXSwibmFtZXMiOlsic3RyZWFtVGV4dCIsInRvb2wiLCJjcmVhdGVHb29nbGVHZW5lcmF0aXZlQUkiLCJWZXJjZWxBSVRvb2xTZXQiLCJ6IiwiZ29vZ2xlQUkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0dFTkVSQVRJVkVfQUlfQVBJX0tFWSIsInJ1bnRpbWUiLCJtYXhEdXJhdGlvbiIsIlBPU1QiLCJyZXEiLCJjb25zb2xlIiwibG9nIiwibWVzc2FnZXMiLCJqc29uIiwiZW50aXR5SWQiLCJoZWFkZXJzIiwiZ2V0IiwibGVuZ3RoIiwiUmVzcG9uc2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJzdGF0dXMiLCJjb21wb3Npb0FwaUtleSIsIkNPTVBPU0lPX0FQSV9LRVkiLCJ0b29sc2V0IiwiY29tcG9zaW9Ub29scyIsImdldFRvb2xzIiwiYXBwcyIsIk9iamVjdCIsImtleXMiLCJyZWFkT25seVRvb2xzIiwid3JpdGVBY3Rpb25LZXl3b3JkcyIsInRvb2xOYW1lIiwiZW50cmllcyIsImlzV3JpdGVBY3Rpb24iLCJzb21lIiwia2V5d29yZCIsInRvVXBwZXJDYXNlIiwiaW5jbHVkZXMiLCJwcm9wb3NlX2NhbGVuZGFyX2V2ZW50IiwiZGVzY3JpcHRpb24iLCJwYXJhbWV0ZXJzIiwib2JqZWN0Iiwic3VtbWFyeSIsInN0cmluZyIsImRlc2NyaWJlIiwic3RhcnQiLCJlbmQiLCJvcHRpb25hbCIsImF0dGVuZGVlcyIsImFycmF5IiwiZW1haWwiLCJleGVjdXRlIiwicGFyYW1zIiwiY29uZmlybWF0aW9uUmVxdWlyZWQiLCJ0eXBlIiwicHJvcG9zYWxJZCIsImNyeXB0byIsInJhbmRvbVVVSUQiLCJzbGljZSIsInByb3Bvc2VkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJtZXNzYWdlSW5kZXgiLCJub3ciLCJjdXJyZW50RGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsIndlZWtkYXkiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJjdXJyZW50VGltZSIsInRvTG9jYWxlVGltZVN0cmluZyIsImhvdXIiLCJtaW51dGUiLCJ0aW1lWm9uZU5hbWUiLCJzeXN0ZW1Qcm9tcHQiLCJyZXN1bHQiLCJtb2RlbCIsInRvb2xzIiwic3lzdGVtIiwibWF4U3RlcHMiLCJvblN0ZXBGaW5pc2giLCJ0ZXh0IiwidG9vbENhbGxzIiwidG9vbFJlc3VsdHMiLCJmaW5pc2hSZWFzb24iLCJoYXNUZXh0IiwidG9vbENhbGxzQ291bnQiLCJ0b29sUmVzdWx0c0NvdW50IiwiZm9yRWFjaCIsInRyIiwiaSIsInRvRGF0YVN0cmVhbVJlc3BvbnNlIiwiZ2V0RXJyb3JNZXNzYWdlIiwiRXJyb3IiLCJtZXNzYWdlIiwiZGV0YWlscyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/zod","vendor-chunks/@langchain","vendor-chunks/ai","vendor-chunks/langsmith","vendor-chunks/pusher-js","vendor-chunks/composio-core","vendor-chunks/@ai-sdk","vendor-chunks/mime-db","vendor-chunks/axios","vendor-chunks/zod-to-json-schema","vendor-chunks/semver","vendor-chunks/@cfworker","vendor-chunks/follow-redirects","vendor-chunks/debug","vendor-chunks/form-data","vendor-chunks/get-intrinsic","vendor-chunks/p-queue","vendor-chunks/eventemitter3","vendor-chunks/js-tiktoken","vendor-chunks/asynckit","vendor-chunks/secure-json-parse","vendor-chunks/combined-stream","vendor-chunks/@hey-api","vendor-chunks/base64-js","vendor-chunks/ansi-styles","vendor-chunks/mime-types","vendor-chunks/proxy-from-env","vendor-chunks/camelcase","vendor-chunks/ms","vendor-chunks/supports-color","vendor-chunks/has-symbols","vendor-chunks/delayed-stream","vendor-chunks/function-bind","vendor-chunks/nanoid","vendor-chunks/p-timeout","vendor-chunks/es-set-tostringtag","vendor-chunks/get-proto","vendor-chunks/call-bind-apply-helpers","vendor-chunks/dunder-proto","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/has-flag","vendor-chunks/decamelize","vendor-chunks/gopd","vendor-chunks/p-finally","vendor-chunks/es-define-property","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/es-object-atoms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdarrenz%2FDocuments%2FMiscProjects%2FAI%20Agent%20Test&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();